(function(angular){
'use strict';
angular
  .module('root', [
    'common',
    'components',
    'templates'
  ]);
})(window.angular);
(function(angular){
'use strict';
angular
  .module('common', [
    'ui.router'
  ]);
})(window.angular);
(function(angular){
'use strict';
angular
  .module('components.auth', [
    'ui.router',
    'ngParse'
  ])
  .config(["ParseProvider", function (ParseProvider) {

        var MY_PARSE_APP_ID = 'gCzy5QzwosCOQ0mpzqseBFy1aPxTt8MFmSa5McsH';
        var MY_PARSE_JS_KEY = 'e6A01sItBnQujBgZToH8yzwz28AskSVlwBN9G8tW';
        ParseProvider.initialize(MY_PARSE_APP_ID, MY_PARSE_JS_KEY);
        ParseProvider.serverURL = 'https://parseapi.back4app.com/';

    }])

  .run(["$transitions", "$state", "AuthService", function ($transitions, $state, AuthService) {
    $transitions.onStart({
      to: function (state) {
        return !!(state.data && state.data.requiredAuth);
      }
    }, function() {
      return AuthService
        .requireAuthentication()
        .catch(function () {
          return $state.target('auth.login');
        });
    });
    $transitions.onStart({
      to: 'auth.*'
    }, function () {
      if (AuthService.isAuthenticated()) {
        return $state.target('app');
      }
    });
  }]);
})(window.angular);
(function(angular){
'use strict';
angular
  .module('components', [
    'components.auth'
  ])
})(window.angular);
(function(angular){
'use strict';
// angular
//   .module('components.contact', [
//     'ui.router'
//   ]);
})(window.angular);
(function(angular){
'use strict';
var root = {
  templateUrl: './root.html'
};

angular
  .module('root')
  .component('root', root);
})(window.angular);
(function(angular){
'use strict';
var appNav = {
  bindings: {
    user: '<',
    onLogout: '&'
  },
  templateUrl: './app-nav.html'
};

angular
  .module('common')
  .component('appNav', appNav);
})(window.angular);
(function(angular){
'use strict';
var app = {
  templateUrl: './app.html',
  controller: 'AppController'
};

angular
  .module('common')
  .component('app', app)
  .config(["$stateProvider", function ($stateProvider) {
    $stateProvider
      .state('app', {
        // redirectTo: 'contacts',
        url: '/app',
        data: {
          requiredAuth: true
        },
        component: 'app'
      })
  }]);
})(window.angular);
(function(angular){
'use strict';
AppController.$inject = ["AuthService", "$state"];
function AppController(AuthService, $state) {
  var ctrl = this;
  ctrl.user = AuthService.getUser();
  ctrl.logout = function () {
    AuthService.logout().then(function () {
      $state.go('auth.login');
    });
  };
}

angular
  .module('common')
  .controller('AppController', AppController);
})(window.angular);
(function(angular){
'use strict';
init.$inject = ["$uiRouter"];
function init($uiRouter) {
  var Visualizer = window['ui-router-visualizer'].Visualizer;
  var pluginInstance = $uiRouter.plugin(Visualizer);
}

angular
  .module('common')
  .run(init)
})(window.angular);
(function(angular){
'use strict';

AuthService.$inject = ["Parse"];
function AuthService(Parse) {
  var auth = new Parse.User(); // creates a new user in Parse
  var currentUser = null; //holds info about current user

  /**
 * Takes in user info, then saves that info into currentUser object
 * @param   {object} response  user object
 *
 * @returns {object} returns currentUser object
 */

  function storeAuthData(response) {
    currentUser = response;
    return currentUser;
  }

    /**
   * Clears currentUser info
   *
   * @returns {object} returns a blank user object
   */

  function clearAuthData() {
    currentUser = Parse.User.current(); // this will now be null
    return currentUser;
  }

  /**
 * Takes in user object from auth-form, returns Parse.user, then stores that data in current User object if there is no error
 * @param {object} user user data from auth-form submit
 *
 * @return {object} returns the parse.user object
 */

//Function takes in user inputted data then returns
  this.login = function(user) {
    return Parse.User
      .logIn(user.email, user.password, {
        success: function(auth) {},
        error: function(auth, error) {
          console.log(error);
        }
      })
      .then(storeAuthData);
  };

  /**
 * Takes in user object from auth-form,then stores data in parse
 * @param {object} user user data from auth-form submit
 *
 * @return {object} returns auth
 */

  this.register = function(user) {
    //console.log("User: ", user);
    auth.set("username", user.email);
    auth.set("password", user.password);
    auth.set("email", user.email);
    return auth
      .signUp(null, {
        success: function(auth) {},
        error: function(auth, error) {
          alert("Error: " + error.code + " " + error.message);
        }
      })
      .then(storeAuthData);
  };

  /**
 * Clears current user data
 *
 * @return {object} returns an empty user object
 */

  this.logout = function() {
    return Parse.User.logOut().then(clearAuthData);
  };

  /**
 * Checks for authentication, converts boolean to promise
 *
 * @return {promise} returns a promise, converted from function that returns user authentication
 */

  this.requireAuthentication = function() {
    return new Promise(function(resolve, reject) {
      if (!!currentUser && currentUser.authenticated()) {
        resolve();
      } else {
        reject();
      }
    });
  }

  /**
 * Checks for authentication
 *
 * @return {boolean} returns a true or false statement based on user authentication
 */

  this.isAuthenticated = function() {
    return !!currentUser;
  };

  this.getUser = function() {
    if (currentUser) {
      return currentUser;
    }
  };
};

angular
  .module('components.auth')
  .service('AuthService', AuthService);
})(window.angular);
(function(angular){
'use strict';
var authForm = {
  bindings: {
    user: '<',
    button: '@',
    message: '@',
    onSubmit: '&'
  },
  templateUrl: './auth-form.html',
  controller: 'AuthFormController'
};

angular
  .module('components.auth')
  .component('authForm', authForm);
})(window.angular);
(function(angular){
'use strict';
function AuthFormController() {
  var ctrl = this;
  ctrl.$onChanges = function (changes) {
    if (changes.user) {
      ctrl.user = angular.copy(ctrl.user);
    }
  };
  ctrl.submitForm = function () {
    //console.log("submit called");
    ctrl.onSubmit({
      $event: {
        user: ctrl.user
      }
    });
  };
}

angular
  .module('components.auth')
  .controller('AuthFormController', AuthFormController);
})(window.angular);
(function(angular){
'use strict';
var login = {
  templateUrl: './login.html',
  controller: 'LoginController'
};

angular
  .module('components.auth')
  .component('login', login)
  .config(["$stateProvider", "$urlRouterProvider", function ($stateProvider, $urlRouterProvider) {
    $stateProvider
      .state('auth', {
        redirectTo: 'auth.login',
        url: '/auth',
        template: '<div ui-view></div>'
      })
      .state('auth.login', {
        url: '/login',
        component: 'login'
      });
    $urlRouterProvider.otherwise('/auth/login');
  }]);
})(window.angular);
(function(angular){
'use strict';
LoginController.$inject = ["AuthService", "$state"];
function LoginController(AuthService, $state) {
  var ctrl = this;

  //initialize user data
  ctrl.$onInit = function () {
    ctrl.error = null;
    ctrl.user = {
      email: '',
      password: ''
    };
  };

  //give user access to app
  ctrl.loginUser = function (event) {
    return AuthService
      .login(event.user)
      .then(function () {
        $state.go('app');
      }, function (reason) {
        ctrl.error = reason.message;
      });
  };
}

angular
  .module('components.auth')
  .controller('LoginController', LoginController);
})(window.angular);
(function(angular){
'use strict';
var register = {
  templateUrl: './register.html',
  controller: 'RegisterController'
};

angular
  .module('components.auth')
  .component('register', register)
  .config(["$stateProvider", function ($stateProvider) {
    $stateProvider
      .state('auth.register', {
        url: '/register',
        component: 'register'
      });
  }]);
})(window.angular);
(function(angular){
'use strict';
RegisterController.$inject = ["AuthService", "$state"];
function RegisterController(AuthService, $state) {
  var ctrl = this;

  //initialize user data
  ctrl.$onInit = function () {
    ctrl.error = null;
    ctrl.user = {
      email: '',
      password: ''
    };
  };

  //creates a new user and allows access into the app
  ctrl.createUser = function (event) {
    //console.log("user:", event);
    return AuthService
      .register(event.user)
      .then(function () {
        $state.go('app');
      }, function (reason) {
        ctrl.error = reason.message;
      });
  };

}

angular
  .module('components.auth')
  .controller('RegisterController', RegisterController);
})(window.angular);
(function(angular){
'use strict';
angular.module('templates', []).run(['$templateCache', function($templateCache) {$templateCache.put('./root.html','<div class="root">\n  <div ui-view></div>\n</div>\n');
$templateCache.put('./app-nav.html','<header class="header">\n  <div class="header__fixed">\n    <div>\n      <div class="header__brand">\n        Contacts\n        <a ui-sref="new" class="header__button header__button--new-contact">\n          <i class="material-icons">add_circle_outline</i>\n          New Contact\n        </a>\n      </div>\n      <div class="header__logout">\n        {{ ::$ctrl.user.email }}\n        <a href="" ng-click="$ctrl.onLogout();">\n          <span class="header__button">\n            <i class="material-icons">power_settings_new</i>\n            Logout\n          </span>\n        </a>\n      </div>\n    </div>\n  </div>\n</header>\n');
$templateCache.put('./app.html','<div class="root">\n  <app-nav user="$ctrl.user" on-logout="$ctrl.logout();"></app-nav>\n  <div class="app">\n    <div ui-view></div>\n  </div>\n</div>\n');
$templateCache.put('./auth-form.html','<form name="authForm" novalidate ng-submit="$ctrl.submitForm();">\n  <label>\n    <input\n      type="email"\n      name="email"\n      required="required"\n      placeholder="Enter your email"\n      ng-model="$ctrl.user.email">\n  </label>\n  <label>\n    <input\n      type="password"\n      name="password"\n      required="required"\n      placeholder="Enter your password"\n      ng-model="$ctrl.user.password">\n  </label>\n  <div class="auth-button">\n    <button type="submit" ng-disabled="authForm.$invalid">\n      {{ $ctrl.button }}\n    </button>\n  </div>\n  <div ng-if="$ctrl.message">\n    {{ $ctrl.message }}\n  </div>\n</form>\n');
$templateCache.put('./login.html','<div class="auth">\n  <h1>Login</h1>\n  <auth-form\n    user="$ctrl.user"\n    message="{{ $ctrl.error }}"\n    button="Login"\n    on-submit="$ctrl.loginUser($event);">\n  </auth-form>\n</div>\n<div class="auth__info">\n  <a ui-sref="auth.register">\n    Don\'t have an account? Create one here.\n  </a>\n</div>\n');
$templateCache.put('./register.html','<div class="auth">\n  <h1>Register</h1>\n  <auth-form\n    user="$ctrl.user"\n    message="{{ $ctrl.error }}"\n    button="Create user"\n    on-submit="$ctrl.createUser($event);">\n  </auth-form>\n</div>\n<div class="auth__info">\n  <a ui-sref="auth.login">\n    Already have an account? Login here.\n  </a>\n</div>\n');}]);})(window.angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvb3QubW9kdWxlLmpzIiwiY29tbW9uL2FwcC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2F1dGgvY29tcG9uZW50cy5tb2R1bGUuanMiLCJjb21wb25lbnRzL2NvbnRhY3QvY29udGFjdC5tb2R1bGUuanMiLCJyb290LmNvbXBvbmVudC5qcyIsImNvbW1vbi9hcHAtbmF2LmNvbXBvbmVudC5qcyIsImNvbW1vbi9hcHAuY29tcG9uZW50LmpzIiwiY29tbW9uL2FwcC5jb250cm9sbGVyLmpzIiwiY29tbW9uL2FwcC5ydW4uanMiLCJjb21wb25lbnRzL2F1dGgvYXV0aC5zZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9hdXRoL2F1dGgtZm9ybS9hdXRoLWZvcm0uY29tcG9uZW50LmpzIiwiY29tcG9uZW50cy9hdXRoL2F1dGgtZm9ybS9hdXRoLWZvcm0uY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvYXV0aC9sb2dpbi9sb2dpbi5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL2F1dGgvbG9naW4vbG9naW4uY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvYXV0aC9yZWdpc3Rlci9yZWdpc3Rlci5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL2F1dGgvcmVnaXN0ZXIvcmVnaXN0ZXIuY29udHJvbGxlci5qcyIsInRlbXBsYXRlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxDQUFBLFNBQUEsUUFBQTtBQUNBO0FBQ0E7R0FDQSxPQUFBLFFBQUE7SUFDQTtJQUNBO0lBQ0E7O0dBRUEsT0FBQTtBQ1JBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQTtHQUNBLE9BQUEsVUFBQTtJQUNBOztHQUVBLE9BQUE7QUNOQSxDQUFBLFNBQUEsUUFBQTtBQUNBO0FBQ0E7R0FDQSxPQUFBLG1CQUFBO0lBQ0E7SUFDQTs7R0FFQSx5QkFBQSxVQUFBLGVBQUE7O1FBRUEsSUFBQSxrQkFBQTtRQUNBLElBQUEsa0JBQUE7UUFDQSxjQUFBLFdBQUEsaUJBQUE7UUFDQSxjQUFBLFlBQUE7Ozs7R0FJQSw4Q0FBQSxVQUFBLGNBQUEsUUFBQSxhQUFBO0lBQ0EsYUFBQSxRQUFBO01BQ0EsSUFBQSxVQUFBLE9BQUE7UUFDQSxPQUFBLENBQUEsRUFBQSxNQUFBLFFBQUEsTUFBQSxLQUFBOztPQUVBLFdBQUE7TUFDQSxPQUFBO1NBQ0E7U0FDQSxNQUFBLFlBQUE7VUFDQSxPQUFBLE9BQUEsT0FBQTs7O0lBR0EsYUFBQSxRQUFBO01BQ0EsSUFBQTtPQUNBLFlBQUE7TUFDQSxJQUFBLFlBQUEsbUJBQUE7UUFDQSxPQUFBLE9BQUEsT0FBQTs7OztHQUlBLE9BQUE7QUNwQ0EsQ0FBQSxTQUFBLFFBQUE7QUFDQTtBQUNBO0dBQ0EsT0FBQSxjQUFBO0lBQ0E7O0dBRUEsT0FBQTtBQ05BLENBQUEsU0FBQSxRQUFBO0FBQ0E7Ozs7O0dBS0EsT0FBQTtBQ05BLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQSxJQUFBLE9BQUE7RUFDQSxhQUFBOzs7QUFHQTtHQUNBLE9BQUE7R0FDQSxVQUFBLFFBQUE7R0FDQSxPQUFBO0FDVEEsQ0FBQSxTQUFBLFFBQUE7QUFDQTtBQUNBLElBQUEsU0FBQTtFQUNBLFVBQUE7SUFDQSxNQUFBO0lBQ0EsVUFBQTs7RUFFQSxhQUFBOzs7QUFHQTtHQUNBLE9BQUE7R0FDQSxVQUFBLFVBQUE7R0FDQSxPQUFBO0FDYkEsQ0FBQSxTQUFBLFFBQUE7QUFDQTtBQUNBLElBQUEsTUFBQTtFQUNBLGFBQUE7RUFDQSxZQUFBOzs7QUFHQTtHQUNBLE9BQUE7R0FDQSxVQUFBLE9BQUE7R0FDQSwwQkFBQSxVQUFBLGdCQUFBO0lBQ0E7T0FDQSxNQUFBLE9BQUE7O1FBRUEsS0FBQTtRQUNBLE1BQUE7VUFDQSxjQUFBOztRQUVBLFdBQUE7OztHQUdBLE9BQUE7QUNyQkEsQ0FBQSxTQUFBLFFBQUE7O21EQUNBO0FBQ0EsU0FBQSxjQUFBLGFBQUEsUUFBQTtFQUNBLElBQUEsT0FBQTtFQUNBLEtBQUEsT0FBQSxZQUFBO0VBQ0EsS0FBQSxTQUFBLFlBQUE7SUFDQSxZQUFBLFNBQUEsS0FBQSxZQUFBO01BQ0EsT0FBQSxHQUFBOzs7OztBQUtBO0dBQ0EsT0FBQTtHQUNBLFdBQUEsaUJBQUE7R0FDQSxPQUFBO0FDZkEsQ0FBQSxTQUFBLFFBQUE7OzhCQUNBO0FBQ0EsU0FBQSxLQUFBLFdBQUE7RUFDQSxJQUFBLGFBQUEsT0FBQSx3QkFBQTtFQUNBLElBQUEsaUJBQUEsVUFBQSxPQUFBOzs7QUFHQTtHQUNBLE9BQUE7R0FDQSxJQUFBO0dBQ0EsT0FBQTtBQ1ZBLENBQUEsU0FBQSxRQUFBO0FBQ0E7OztBQUVBLFNBQUEsWUFBQSxPQUFBO0VBQ0EsSUFBQSxPQUFBLElBQUEsTUFBQTtFQUNBLElBQUEsY0FBQTs7Ozs7Ozs7O0VBU0EsU0FBQSxjQUFBLFVBQUE7SUFDQSxjQUFBO0lBQ0EsT0FBQTs7Ozs7Ozs7O0VBU0EsU0FBQSxnQkFBQTtJQUNBLGNBQUEsTUFBQSxLQUFBO0lBQ0EsT0FBQTs7Ozs7Ozs7Ozs7RUFXQSxLQUFBLFFBQUEsU0FBQSxNQUFBO0lBQ0EsT0FBQSxNQUFBO09BQ0EsTUFBQSxLQUFBLE9BQUEsS0FBQSxVQUFBO1FBQ0EsU0FBQSxTQUFBLE1BQUE7UUFDQSxPQUFBLFNBQUEsTUFBQSxPQUFBO1VBQ0EsUUFBQSxJQUFBOzs7T0FHQSxLQUFBOzs7Ozs7Ozs7O0VBVUEsS0FBQSxXQUFBLFNBQUEsTUFBQTs7SUFFQSxLQUFBLElBQUEsWUFBQSxLQUFBO0lBQ0EsS0FBQSxJQUFBLFlBQUEsS0FBQTtJQUNBLEtBQUEsSUFBQSxTQUFBLEtBQUE7SUFDQSxPQUFBO09BQ0EsT0FBQSxNQUFBO1FBQ0EsU0FBQSxTQUFBLE1BQUE7UUFDQSxPQUFBLFNBQUEsTUFBQSxPQUFBO1VBQ0EsTUFBQSxZQUFBLE1BQUEsT0FBQSxNQUFBLE1BQUE7OztPQUdBLEtBQUE7Ozs7Ozs7OztFQVNBLEtBQUEsU0FBQSxXQUFBO0lBQ0EsT0FBQSxNQUFBLEtBQUEsU0FBQSxLQUFBOzs7Ozs7Ozs7RUFTQSxLQUFBLHdCQUFBLFdBQUE7SUFDQSxPQUFBLElB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SUFBQSxlQUFBO0FBQ0EsZUFBQSxJQUFBLGtCQUFBLHdVQUFBLE9BQUEsU0FBQSIsImZpbGUiOiJtYWluLTE1MjU0Njc0MDQ2NzQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhclxuICAubW9kdWxlKCdyb290JywgW1xuICAgICdjb21tb24nLFxuICAgICdjb21wb25lbnRzJyxcbiAgICAndGVtcGxhdGVzJ1xuICBdKTtcbiIsImFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tbW9uJywgW1xuICAgICd1aS5yb3V0ZXInXG4gIF0pO1xuIiwiYW5ndWxhclxuICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnLCBbXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ25nUGFyc2UnXG4gIF0pXG4gIC5jb25maWcoZnVuY3Rpb24gKFBhcnNlUHJvdmlkZXIpIHtcblxuICAgICAgICB2YXIgTVlfUEFSU0VfQVBQX0lEID0gJ2dDenk1UXp3b3NDT1EwbXB6cXNlQkZ5MWFQeFR0OE1GbVNhNU1jc0gnO1xuICAgICAgICB2YXIgTVlfUEFSU0VfSlNfS0VZID0gJ2U2QTAxc0l0Qm5RdWpCZ1pUb0g4eXp3ejI4QXNrU1Zsd0JOOUc4dFcnO1xuICAgICAgICBQYXJzZVByb3ZpZGVyLmluaXRpYWxpemUoTVlfUEFSU0VfQVBQX0lELCBNWV9QQVJTRV9KU19LRVkpO1xuICAgICAgICBQYXJzZVByb3ZpZGVyLnNlcnZlclVSTCA9ICdodHRwczovL3BhcnNlYXBpLmJhY2s0YXBwLmNvbS8nO1xuXG4gICAgfSlcblxuICAucnVuKGZ1bmN0aW9uICgkdHJhbnNpdGlvbnMsICRzdGF0ZSwgQXV0aFNlcnZpY2UpIHtcbiAgICAkdHJhbnNpdGlvbnMub25TdGFydCh7XG4gICAgICB0bzogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiAhIShzdGF0ZS5kYXRhICYmIHN0YXRlLmRhdGEucmVxdWlyZWRBdXRoKTtcbiAgICAgIH1cbiAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBBdXRoU2VydmljZVxuICAgICAgICAucmVxdWlyZUF1dGhlbnRpY2F0aW9uKClcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJHN0YXRlLnRhcmdldCgnYXV0aC5sb2dpbicpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICAkdHJhbnNpdGlvbnMub25TdGFydCh7XG4gICAgICB0bzogJ2F1dGguKidcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmV0dXJuICRzdGF0ZS50YXJnZXQoJ2FwcCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiIsImFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcG9uZW50cycsIFtcbiAgICAnY29tcG9uZW50cy5hdXRoJ1xuICBdKVxuIiwiLy8gYW5ndWxhclxuLy8gICAubW9kdWxlKCdjb21wb25lbnRzLmNvbnRhY3QnLCBbXG4vLyAgICAgJ3VpLnJvdXRlcidcbi8vICAgXSk7XG4iLCJ2YXIgcm9vdCA9IHtcbiAgdGVtcGxhdGVVcmw6ICcuL3Jvb3QuaHRtbCdcbn07XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgncm9vdCcpXG4gIC5jb21wb25lbnQoJ3Jvb3QnLCByb290KTtcbiIsInZhciBhcHBOYXYgPSB7XG4gIGJpbmRpbmdzOiB7XG4gICAgdXNlcjogJzwnLFxuICAgIG9uTG9nb3V0OiAnJidcbiAgfSxcbiAgdGVtcGxhdGVVcmw6ICcuL2FwcC1uYXYuaHRtbCdcbn07XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tbW9uJylcbiAgLmNvbXBvbmVudCgnYXBwTmF2JywgYXBwTmF2KTtcbiIsInZhciBhcHAgPSB7XG4gIHRlbXBsYXRlVXJsOiAnLi9hcHAuaHRtbCcsXG4gIGNvbnRyb2xsZXI6ICdBcHBDb250cm9sbGVyJ1xufTtcblxuYW5ndWxhclxuICAubW9kdWxlKCdjb21tb24nKVxuICAuY29tcG9uZW50KCdhcHAnLCBhcHApXG4gIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnYXBwJywge1xuICAgICAgICAvLyByZWRpcmVjdFRvOiAnY29udGFjdHMnLFxuICAgICAgICB1cmw6ICcvYXBwJyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHJlcXVpcmVkQXV0aDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBjb21wb25lbnQ6ICdhcHAnXG4gICAgICB9KVxuICB9KTtcbiIsImZ1bmN0aW9uIEFwcENvbnRyb2xsZXIoQXV0aFNlcnZpY2UsICRzdGF0ZSkge1xuICB2YXIgY3RybCA9IHRoaXM7XG4gIGN0cmwudXNlciA9IEF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgY3RybC5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXV0aFNlcnZpY2UubG9nb3V0KCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAkc3RhdGUuZ28oJ2F1dGgubG9naW4nKTtcbiAgICB9KTtcbiAgfTtcbn1cblxuYW5ndWxhclxuICAubW9kdWxlKCdjb21tb24nKVxuICAuY29udHJvbGxlcignQXBwQ29udHJvbGxlcicsIEFwcENvbnRyb2xsZXIpO1xuIiwiZnVuY3Rpb24gaW5pdCgkdWlSb3V0ZXIpIHtcbiAgdmFyIFZpc3VhbGl6ZXIgPSB3aW5kb3dbJ3VpLXJvdXRlci12aXN1YWxpemVyJ10uVmlzdWFsaXplcjtcbiAgdmFyIHBsdWdpbkluc3RhbmNlID0gJHVpUm91dGVyLnBsdWdpbihWaXN1YWxpemVyKTtcbn1cblxuYW5ndWxhclxuICAubW9kdWxlKCdjb21tb24nKVxuICAucnVuKGluaXQpXG4iLCJcbmZ1bmN0aW9uIEF1dGhTZXJ2aWNlKFBhcnNlKSB7XG4gIHZhciBhdXRoID0gbmV3IFBhcnNlLlVzZXIoKTsgLy8gY3JlYXRlcyBhIG5ldyB1c2VyIGluIFBhcnNlXG4gIHZhciBjdXJyZW50VXNlciA9IG51bGw7IC8vaG9sZHMgaW5mbyBhYm91dCBjdXJyZW50IHVzZXJcblxuICAvKipcbiAqIFRha2VzIGluIHVzZXIgaW5mbywgdGhlbiBzYXZlcyB0aGF0IGluZm8gaW50byBjdXJyZW50VXNlciBvYmplY3RcbiAqIEBwYXJhbSAgIHtvYmplY3R9IHJlc3BvbnNlICB1c2VyIG9iamVjdFxuICpcbiAqIEByZXR1cm5zIHtvYmplY3R9IHJldHVybnMgY3VycmVudFVzZXIgb2JqZWN0XG4gKi9cblxuICBmdW5jdGlvbiBzdG9yZUF1dGhEYXRhKHJlc3BvbnNlKSB7XG4gICAgY3VycmVudFVzZXIgPSByZXNwb25zZTtcbiAgICByZXR1cm4gY3VycmVudFVzZXI7XG4gIH1cblxuICAgIC8qKlxuICAgKiBDbGVhcnMgY3VycmVudFVzZXIgaW5mb1xuICAgKlxuICAgKiBAcmV0dXJucyB7b2JqZWN0fSByZXR1cm5zIGEgYmxhbmsgdXNlciBvYmplY3RcbiAgICovXG5cbiAgZnVuY3Rpb24gY2xlYXJBdXRoRGF0YSgpIHtcbiAgICBjdXJyZW50VXNlciA9IFBhcnNlLlVzZXIuY3VycmVudCgpOyAvLyB0aGlzIHdpbGwgbm93IGJlIG51bGxcbiAgICByZXR1cm4gY3VycmVudFVzZXI7XG4gIH1cblxuICAvKipcbiAqIFRha2VzIGluIHVzZXIgb2JqZWN0IGZyb20gYXV0aC1mb3JtLCByZXR1cm5zIFBhcnNlLnVzZXIsIHRoZW4gc3RvcmVzIHRoYXQgZGF0YSBpbiBjdXJyZW50IFVzZXIgb2JqZWN0IGlmIHRoZXJlIGlzIG5vIGVycm9yXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciB1c2VyIGRhdGEgZnJvbSBhdXRoLWZvcm0gc3VibWl0XG4gKlxuICogQHJldHVybiB7b2JqZWN0fSByZXR1cm5zIHRoZSBwYXJzZS51c2VyIG9iamVjdFxuICovXG5cbi8vRnVuY3Rpb24gdGFrZXMgaW4gdXNlciBpbnB1dHRlZCBkYXRhIHRoZW4gcmV0dXJuc1xuICB0aGlzLmxvZ2luID0gZnVuY3Rpb24odXNlcikge1xuICAgIHJldHVybiBQYXJzZS5Vc2VyXG4gICAgICAubG9nSW4odXNlci5lbWFpbCwgdXNlci5wYXNzd29yZCwge1xuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihhdXRoKSB7fSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGF1dGgsIGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4oc3RvcmVBdXRoRGF0YSk7XG4gIH07XG5cbiAgLyoqXG4gKiBUYWtlcyBpbiB1c2VyIG9iamVjdCBmcm9tIGF1dGgtZm9ybSx0aGVuIHN0b3JlcyBkYXRhIGluIHBhcnNlXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciB1c2VyIGRhdGEgZnJvbSBhdXRoLWZvcm0gc3VibWl0XG4gKlxuICogQHJldHVybiB7b2JqZWN0fSByZXR1cm5zIGF1dGhcbiAqL1xuXG4gIHRoaXMucmVnaXN0ZXIgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgLy9jb25zb2xlLmxvZyhcIlVzZXI6IFwiLCB1c2VyKTtcbiAgICBhdXRoLnNldChcInVzZXJuYW1lXCIsIHVzZXIuZW1haWwpO1xuICAgIGF1dGguc2V0KFwicGFzc3dvcmRcIiwgdXNlci5wYXNzd29yZCk7XG4gICAgYXV0aC5zZXQoXCJlbWFpbFwiLCB1c2VyLmVtYWlsKTtcbiAgICByZXR1cm4gYXV0aFxuICAgICAgLnNpZ25VcChudWxsLCB7XG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGF1dGgpIHt9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24oYXV0aCwgZXJyb3IpIHtcbiAgICAgICAgICBhbGVydChcIkVycm9yOiBcIiArIGVycm9yLmNvZGUgKyBcIiBcIiArIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4oc3RvcmVBdXRoRGF0YSk7XG4gIH07XG5cbiAgLyoqXG4gKiBDbGVhcnMgY3VycmVudCB1c2VyIGRhdGFcbiAqXG4gKiBAcmV0dXJuIHtvYmplY3R9IHJldHVybnMgYW4gZW1wdHkgdXNlciBvYmplY3RcbiAqL1xuXG4gIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIFBhcnNlLlVzZXIubG9nT3V0KCkudGhlbihjbGVhckF1dGhEYXRhKTtcbiAgfTtcblxuICAvKipcbiAqIENoZWNrcyBmb3IgYXV0aGVudGljYXRpb24sIGNvbnZlcnRzIGJvb2xlYW4gdG8gcHJvbWlzZVxuICpcbiAqIEByZXR1cm4ge3Byb21pc2V9IHJldHVybnMgYSBwcm9taXNlLCBjb252ZXJ0ZWQgZnJvbSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdXNlciBhdXRoZW50aWNhdGlvblxuICovXG5cbiAgdGhpcy5yZXF1aXJlQXV0aGVudGljYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBpZiAoISFjdXJyZW50VXNlciAmJiBjdXJyZW50VXNlci5hdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVqZWN0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAqIENoZWNrcyBmb3IgYXV0aGVudGljYXRpb25cbiAqXG4gKiBAcmV0dXJuIHtib29sZWFufSByZXR1cm5zIGEgdHJ1ZSBvciBmYWxzZSBzdGF0ZW1lbnQgYmFzZWQgb24gdXNlciBhdXRoZW50aWNhdGlvblxuICovXG5cbiAgdGhpcy5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gISFjdXJyZW50VXNlcjtcbiAgfTtcblxuICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybiBjdXJyZW50VXNlcjtcbiAgICB9XG4gIH07XG59O1xuXG5hbmd1bGFyXG4gIC5tb2R1bGUoJ2NvbXBvbmVudHMuYXV0aCcpXG4gIC5zZXJ2aWNlKCdBdXRoU2VydmljZScsIEF1dGhTZXJ2aWNlKTtcbiIsInZhciBhdXRoRm9ybSA9IHtcbiAgYmluZGluZ3M6IHtcbiAgICB1c2VyOiAnPCcsXG4gICAgYnV0dG9uOiAnQCcsXG4gICAgbWVzc2FnZTogJ0AnLFxuICAgIG9uU3VibWl0OiAnJidcbiAgfSxcbiAgdGVtcGxhdGVVcmw6ICcuL2F1dGgtZm9ybS5odG1sJyxcbiAgY29udHJvbGxlcjogJ0F1dGhGb3JtQ29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcG9uZW50cy5hdXRoJylcbiAgLmNvbXBvbmVudCgnYXV0aEZvcm0nLCBhdXRoRm9ybSk7XG4iLCJmdW5jdGlvbiBBdXRoRm9ybUNvbnRyb2xsZXIoKSB7XG4gIHZhciBjdHJsID0gdGhpcztcbiAgY3RybC4kb25DaGFuZ2VzID0gZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy51c2VyKSB7XG4gICAgICBjdHJsLnVzZXIgPSBhbmd1bGFyLmNvcHkoY3RybC51c2VyKTtcbiAgICB9XG4gIH07XG4gIGN0cmwuc3VibWl0Rm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL2NvbnNvbGUubG9nKFwic3VibWl0IGNhbGxlZFwiKTtcbiAgICBjdHJsLm9uU3VibWl0KHtcbiAgICAgICRldmVudDoge1xuICAgICAgICB1c2VyOiBjdHJsLnVzZXJcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cblxuYW5ndWxhclxuICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAuY29udHJvbGxlcignQXV0aEZvcm1Db250cm9sbGVyJywgQXV0aEZvcm1Db250cm9sbGVyKTtcbiIsInZhciBsb2dpbiA9IHtcbiAgdGVtcGxhdGVVcmw6ICcuL2xvZ2luLmh0bWwnLFxuICBjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJ1xufTtcblxuYW5ndWxhclxuICAubW9kdWxlKCdjb21wb25lbnRzLmF1dGgnKVxuICAuY29tcG9uZW50KCdsb2dpbicsIGxvZ2luKVxuICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnYXV0aCcsIHtcbiAgICAgICAgcmVkaXJlY3RUbzogJ2F1dGgubG9naW4nLFxuICAgICAgICB1cmw6ICcvYXV0aCcsXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdiB1aS12aWV3PjwvZGl2PidcbiAgICAgIH0pXG4gICAgICAuc3RhdGUoJ2F1dGgubG9naW4nLCB7XG4gICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgIGNvbXBvbmVudDogJ2xvZ2luJ1xuICAgICAgfSk7XG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2F1dGgvbG9naW4nKTtcbiAgfSk7XG4iLCJmdW5jdGlvbiBMb2dpbkNvbnRyb2xsZXIoQXV0aFNlcnZpY2UsICRzdGF0ZSkge1xuICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgLy9pbml0aWFsaXplIHVzZXIgZGF0YVxuICBjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY3RybC5lcnJvciA9IG51bGw7XG4gICAgY3RybC51c2VyID0ge1xuICAgICAgZW1haWw6ICcnLFxuICAgICAgcGFzc3dvcmQ6ICcnXG4gICAgfTtcbiAgfTtcblxuICAvL2dpdmUgdXNlciBhY2Nlc3MgdG8gYXBwXG4gIGN0cmwubG9naW5Vc2VyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgcmV0dXJuIEF1dGhTZXJ2aWNlXG4gICAgICAubG9naW4oZXZlbnQudXNlcilcbiAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdhcHAnKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgY3RybC5lcnJvciA9IHJlYXNvbi5tZXNzYWdlO1xuICAgICAgfSk7XG4gIH07XG59XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcG9uZW50cy5hdXRoJylcbiAgLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIExvZ2luQ29udHJvbGxlcik7XG4iLCJ2YXIgcmVnaXN0ZXIgPSB7XG4gIHRlbXBsYXRlVXJsOiAnLi9yZWdpc3Rlci5odG1sJyxcbiAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ29udHJvbGxlcidcbn07XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcG9uZW50cy5hdXRoJylcbiAgLmNvbXBvbmVudCgncmVnaXN0ZXInLCByZWdpc3RlcilcbiAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdhdXRoLnJlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICBjb21wb25lbnQ6ICdyZWdpc3RlcidcbiAgICAgIH0pO1xuICB9KTtcbiIsImZ1bmN0aW9uIFJlZ2lzdGVyQ29udHJvbGxlcihBdXRoU2VydmljZSwgJHN0YXRlKSB7XG4gIHZhciBjdHJsID0gdGhpcztcblxuICAvL2luaXRpYWxpemUgdXNlciBkYXRhXG4gIGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjdHJsLmVycm9yID0gbnVsbDtcbiAgICBjdHJsLnVzZXIgPSB7XG4gICAgICBlbWFpbDogJycsXG4gICAgICBwYXNzd29yZDogJydcbiAgICB9O1xuICB9O1xuXG4gIC8vY3JlYXRlcyBhIG5ldyB1c2VyIGFuZCBhbGxvd3MgYWNjZXNzIGludG8gdGhlIGFwcFxuICBjdHJsLmNyZWF0ZVVzZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAvL2NvbnNvbGUubG9nKFwidXNlcjpcIiwgZXZlbnQpO1xuICAgIHJldHVybiBBdXRoU2VydmljZVxuICAgICAgLnJlZ2lzdGVyKGV2ZW50LnVzZXIpXG4gICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzdGF0ZS5nbygnYXBwJyk7XG4gICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGN0cmwuZXJyb3IgPSByZWFzb24ubWVzc2FnZTtcbiAgICAgIH0pO1xuICB9O1xuXG59XG5cbmFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcG9uZW50cy5hdXRoJylcbiAgLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ29udHJvbGxlcicsIFJlZ2lzdGVyQ29udHJvbGxlcik7XG4iLCJhbmd1bGFyLm1vZHVsZSgndGVtcGxhdGVzJywgW10pLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHskdGVtcGxhdGVDYWNoZS5wdXQoJy4vcm9vdC5odG1sJywnPGRpdiBjbGFzcz1cInJvb3RcIj5cXG4gIDxkaXYgdWktdmlldz48L2Rpdj5cXG48L2Rpdj5cXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9hcHAtbmF2Lmh0bWwnLCc8aGVhZGVyIGNsYXNzPVwiaGVhZGVyXCI+XFxuICA8ZGl2IGNsYXNzPVwiaGVhZGVyX19maXhlZFwiPlxcbiAgICA8ZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJfX2JyYW5kXCI+XFxuICAgICAgICBDb250YWN0c1xcbiAgICAgICAgPGEgdWktc3JlZj1cIm5ld1wiIGNsYXNzPVwiaGVhZGVyX19idXR0b24gaGVhZGVyX19idXR0b24tLW5ldy1jb250YWN0XCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5hZGRfY2lyY2xlX291dGxpbmU8L2k+XFxuICAgICAgICAgIE5ldyBDb250YWN0XFxuICAgICAgICA8L2E+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlcl9fbG9nb3V0XCI+XFxuICAgICAgICB7eyA6OiRjdHJsLnVzZXIuZW1haWwgfX1cXG4gICAgICAgIDxhIGhyZWY9XCJcIiBuZy1jbGljaz1cIiRjdHJsLm9uTG9nb3V0KCk7XCI+XFxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiaGVhZGVyX19idXR0b25cIj5cXG4gICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+cG93ZXJfc2V0dGluZ3NfbmV3PC9pPlxcbiAgICAgICAgICAgIExvZ291dFxcbiAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8L2E+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuPC9oZWFkZXI+XFxuJyk7XG4kdGVtcGxhdGVDYWNoZS5wdXQoJy4vYXBwLmh0bWwnLCc8ZGl2IGNsYXNzPVwicm9vdFwiPlxcbiAgPGFwcC1uYXYgdXNlcj1cIiRjdHJsLnVzZXJcIiBvbi1sb2dvdXQ9XCIkY3RybC5sb2dvdXQoKTtcIj48L2FwcC1uYXY+XFxuICA8ZGl2IGNsYXNzPVwiYXBwXCI+XFxuICAgIDxkaXYgdWktdmlldz48L2Rpdj5cXG4gIDwvZGl2PlxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL2F1dGgtZm9ybS5odG1sJywnPGZvcm0gbmFtZT1cImF1dGhGb3JtXCIgbm92YWxpZGF0ZSBuZy1zdWJtaXQ9XCIkY3RybC5zdWJtaXRGb3JtKCk7XCI+XFxuICA8bGFiZWw+XFxuICAgIDxpbnB1dFxcbiAgICAgIHR5cGU9XCJlbWFpbFwiXFxuICAgICAgbmFtZT1cImVtYWlsXCJcXG4gICAgICByZXF1aXJlZD1cInJlcXVpcmVkXCJcXG4gICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIHlvdXIgZW1haWxcIlxcbiAgICAgIG5nLW1vZGVsPVwiJGN0cmwudXNlci5lbWFpbFwiPlxcbiAgPC9sYWJlbD5cXG4gIDxsYWJlbD5cXG4gICAgPGlucHV0XFxuICAgICAgdHlwZT1cInBhc3N3b3JkXCJcXG4gICAgICBuYW1lPVwicGFzc3dvcmRcIlxcbiAgICAgIHJlcXVpcmVkPVwicmVxdWlyZWRcIlxcbiAgICAgIHBsYWNlaG9sZGVyPVwiRW50ZXIgeW91ciBwYXNzd29yZFwiXFxuICAgICAgbmctbW9kZWw9XCIkY3RybC51c2VyLnBhc3N3b3JkXCI+XFxuICA8L2xhYmVsPlxcbiAgPGRpdiBjbGFzcz1cImF1dGgtYnV0dG9uXCI+XFxuICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIG5nLWRpc2FibGVkPVwiYXV0aEZvcm0uJGludmFsaWRcIj5cXG4gICAgICB7eyAkY3RybC5idXR0b24gfX1cXG4gICAgPC9idXR0b24+XFxuICA8L2Rpdj5cXG4gIDxkaXYgbmctaWY9XCIkY3RybC5tZXNzYWdlXCI+XFxuICAgIHt7ICRjdHJsLm1lc3NhZ2UgfX1cXG4gIDwvZGl2PlxcbjwvZm9ybT5cXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9sb2dpbi5odG1sJywnPGRpdiBjbGFzcz1cImF1dGhcIj5cXG4gIDxoMT5Mb2dpbjwvaDE+XFxuICA8YXV0aC1mb3JtXFxuICAgIHVzZXI9XCIkY3RybC51c2VyXCJcXG4gICAgbWVzc2FnZT1cInt7ICRjdHJsLmVycm9yIH19XCJcXG4gICAgYnV0dG9uPVwiTG9naW5cIlxcbiAgICBvbi1zdWJtaXQ9XCIkY3RybC5sb2dpblVzZXIoJGV2ZW50KTtcIj5cXG4gIDwvYXV0aC1mb3JtPlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XCJhdXRoX19pbmZvXCI+XFxuICA8YSB1aS1zcmVmPVwiYXV0aC5yZWdpc3RlclwiPlxcbiAgICBEb25cXCd0IGhhdmUgYW4gYWNjb3VudD8gQ3JlYXRlIG9uZSBoZXJlLlxcbiAgPC9hPlxcbjwvZGl2PlxcbicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL3JlZ2lzdGVyLmh0bWwnLCc8ZGl2IGNsYXNzPVwiYXV0aFwiPlxcbiAgPGgxPlJlZ2lzdGVyPC9oMT5cXG4gIDxhdXRoLWZvcm1cXG4gICAgdXNlcj1cIiRjdHJsLnVzZXJcIlxcbiAgICBtZXNzYWdlPVwie3sgJGN0cmwuZXJyb3IgfX1cIlxcbiAgICBidXR0b249XCJDcmVhdGUgdXNlclwiXFxuICAgIG9uLXN1Ym1pdD1cIiRjdHJsLmNyZWF0ZVVzZXIoJGV2ZW50KTtcIj5cXG4gIDwvYXV0aC1mb3JtPlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XCJhdXRoX19pbmZvXCI+XFxuICA8YSB1aS1zcmVmPVwiYXV0aC5sb2dpblwiPlxcbiAgICBBbHJlYWR5IGhhdmUgYW4gYWNjb3VudD8gTG9naW4gaGVyZS5cXG4gIDwvYT5cXG48L2Rpdj5cXG4nKTt9XSk7Il19
